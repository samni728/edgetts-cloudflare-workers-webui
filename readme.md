# CF-TTS Proxy Server (v1.2)

ä¸€ä¸ªéƒ¨ç½²åœ¨ Cloudflare Pages ä¸Šçš„é«˜æ€§èƒ½æ–‡æœ¬è½¬è¯­éŸ³ï¼ˆTTSï¼‰ä»£ç†æœåŠ¡ï¼Œå°†å¾®è½¯ Edge TTS å°è£…æˆå…¼å®¹ OpenAI API çš„æ¥å£ã€‚

## âœ¨ ä¸»è¦ç‰¹æ€§

- **ğŸš€ OpenAI å…¼å®¹**: å®Œå…¨æ¨¡æ‹Ÿ OpenAI çš„ `/v1/audio/speech` æ¥å£
- **ğŸ—£ï¸ é«˜è´¨é‡éŸ³è‰²**: åˆ©ç”¨å¾®è½¯ Edge TTS çš„è‡ªç„¶ç¥ç»ç½‘ç»œè¯­éŸ³
- **âš¡ æµå¼æ’­æ”¾**: æ”¯æŒæµå¼å’Œæ ‡å‡†ä¸¤ç§å“åº”æ¨¡å¼ï¼Œé™ä½é•¿æ–‡æœ¬å»¶è¿Ÿ
- **ğŸ§  æ™ºèƒ½æ–‡æœ¬æ¸…ç†**: è‡ªåŠ¨å¤„ç† Markdownã€Emojiã€URLã€å¼•ç”¨æ ‡è®°ç­‰
- **ğŸ—„ï¸ æ™ºèƒ½å†å²è®°å½•**: æ”¯æŒä¸¤ç§ä¿å­˜æ¨¡å¼
  - **éŸ³é¢‘+æ–‡æœ¬ä¿å­˜**: å®Œæ•´éŸ³é¢‘æ–‡ä»¶å­˜å‚¨ï¼Œé€Ÿåº¦å¿«ï¼Œé€‚åˆæœ‰å£°ä¹¦åˆ¶ä½œ
  - **æ–‡æœ¬+æµå¼æ’­æ”¾**: ä»…ä¿å­˜æ–‡æœ¬ï¼Œå®æ—¶ç”ŸæˆéŸ³é¢‘ï¼Œä¸å å­˜å‚¨ç©ºé—´
- **ğŸ“– æœ‰å£°ä¹¦åŠŸèƒ½**: æ”¯æŒ Markdown æ ¼å¼åˆ†äº«ï¼Œè‡ªåŠ¨ä¼˜åŒ– TTS æ–‡æœ¬è½¬æ¢
- **ğŸ”— è·¨è®¾å¤‡åˆ†äº«**: å¸¦å¯†ç ä¿æŠ¤çš„åˆ†äº«é“¾æ¥ï¼Œå¯ä½œä¸ºä¸´æ—¶ä¿¡æ¯ä¼ é€’å·¥å…·
- **ğŸ” å®‰å…¨è®¿é—®**: API å¯†é’¥éªŒè¯ï¼Œç¡®ä¿æœåŠ¡å®‰å…¨
- **ğŸ†” æ™ºèƒ½ç”¨æˆ·ID**: åŸºäºéƒ¨ç½²åŸŸåè‡ªåŠ¨ç”Ÿæˆå”¯ä¸€ç”¨æˆ·IDï¼Œé¿å…å¤šéƒ¨ç½²å†²çª
- **ğŸ’» å†…ç½® WebUI**: åŠŸèƒ½å®Œæ•´çš„æµ‹è¯•ç•Œé¢ï¼Œæ— éœ€ç¼–ç¨‹å³å¯ä½¿ç”¨

## ğŸš€ å¿«é€Ÿéƒ¨ç½²

### 1. åˆ›å»º Cloudflare Pages é¡¹ç›®

1. ç™»å½• [Cloudflare Dashboard](https://dash.cloudflare.com)
2. ç‚¹å‡» **Workers å’Œ Pages** â†’ **åˆ›å»ºåº”ç”¨ç¨‹åº** â†’ **Pages** â†’ **ä¸Šä¼ èµ„äº§**
3. ä¸Šä¼  [v1.2 Release](https://github.com/samni728/edgetts-cloudflare-workers-webui/releases/tag/v1.2) åœ¨æ·»åŠ å˜é‡å’Œ kv ååŠ¡å¿…åœ¨é‡æ–°éƒ¨ç½²ä¸€æ¬¡æ‰èƒ½ç”Ÿæ•ˆï¼

### 2. é…ç½®ç¯å¢ƒå˜é‡

#### è®¾ç½® API å¯†é’¥
1. åœ¨é¡¹ç›®è®¾ç½®ä¸­æ‰¾åˆ° **ç¯å¢ƒå˜é‡**
2. æ·»åŠ å˜é‡ï¼š
   - **å˜é‡å**: `API_KEY`
   - **å€¼**: ä»»æ„å­—ç¬¦ä¸²ï¼ˆç”¨äº API è®¿é—®æ§åˆ¶ï¼‰
   - **åŠ å¯†**: âœ… å‹¾é€‰

![API_KEY é…ç½®ç¤ºä¾‹](screenshorts/API_KEY.jpg)

### 3. é…ç½® KV å­˜å‚¨ï¼ˆå¿…éœ€ï¼‰

#### åˆ›å»º KV å­˜å‚¨
1. åœ¨ Cloudflare Dashboard ä¸­ï¼Œè¿›å…¥ **Workers å’Œ Pages** â†’ **KV**
2. ç‚¹å‡» **åˆ›å»ºå‘½åç©ºé—´**
3. å‘½åç©ºé—´åç§°ï¼š`TTS_HISTORY`
4. ç‚¹å‡» **æ·»åŠ **

![KV åˆ›å»ºæ­¥éª¤ 1](screenshorts/kv_1.png)

#### ç»‘å®š KV åˆ° Pages é¡¹ç›®
1. è¿›å…¥ä½ çš„ Pages é¡¹ç›®è®¾ç½®
2. æ‰¾åˆ° **è®¾ç½®** â†’ **å‡½æ•°** â†’ **KV å‘½åç©ºé—´ç»‘å®š**
3. ç‚¹å‡» **æ·»åŠ ç»‘å®š**
4. é…ç½®ï¼š
   - **å˜é‡å**: `TTS_HISTORY`
   - **KV å‘½åç©ºé—´**: é€‰æ‹©åˆšåˆ›å»ºçš„ `TTS_HISTORY`
5. ç‚¹å‡» **ä¿å­˜å¹¶éƒ¨ç½²**

![KV ç»‘å®šæ­¥éª¤ 2](screenshorts/kv_2.png)

![KV ç»‘å®šæ­¥éª¤ 3](screenshorts/kv_3_TTS_HISTORY.jpg)

![KV ç»‘å®šæ­¥éª¤ 4](screenshorts/kv_4.png)

## ğŸ“– ä½¿ç”¨æ–¹æ³•

### WebUI ç•Œé¢
è®¿é—®ä½ çš„ Pages åŸŸåï¼Œå³å¯ä½¿ç”¨å†…ç½®çš„ WebUI ç•Œé¢è¿›è¡Œæµ‹è¯•ã€‚

### API è°ƒç”¨ç¤ºä¾‹

```bash
curl -X POST "https://your-domain.pages.dev/v1/audio/speech" \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "model": "tts-1",
    "voice": "shimmer",
    "input": "ä½ å¥½ï¼Œä¸–ç•Œï¼",
    "stream": false
  }' --output audio.mp3
```

### ä¸»è¦å‚æ•°

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `model` | string | `"tts-1"` | æ¨¡å‹ ID |
| `input` | string | **å¿…éœ€** | è¦è½¬æ¢çš„æ–‡æœ¬ |
| `voice` | string | `"alloy"` | éŸ³è‰²é€‰æ‹© |
| `speed` | number | `1.0` | è¯­é€Ÿ (0.25-2.0) |
| `pitch` | number | `1.0` | éŸ³è°ƒ (0.5-1.5) |
| `stream` | boolean | `false` | æ˜¯å¦æµå¼å“åº” |
| `cleaning_options` | object | `{...}` | æ–‡æœ¬æ¸…ç†é€‰é¡¹ |

### æ™ºèƒ½ç”¨æˆ·IDæœºåˆ¶
- **è‡ªåŠ¨ç”Ÿæˆ**: åŸºäºéƒ¨ç½²åŸŸåè‡ªåŠ¨ç”Ÿæˆå”¯ä¸€çš„16ä½åå…­è¿›åˆ¶ç”¨æˆ·ID
- **é¿å…å†²çª**: æ¯ä¸ª Cloudflare Pages åŸŸåéƒ½æœ‰ç‹¬ç‰¹çš„ç”¨æˆ·IDï¼Œé˜²æ­¢å¤šéƒ¨ç½²é—´çš„å†²çª
- **ç¨³å®šæ€§**: åŒä¸€åŸŸåçš„ç”¨æˆ·IDä¿æŒå›ºå®šï¼Œä¸ä¼šé¢‘ç¹å˜åŒ–
- **å…¼å®¹æ€§**: å¦‚æœåŸŸåè§£æå¤±è´¥ï¼Œè‡ªåŠ¨å›é€€åˆ°é»˜è®¤ç”¨æˆ·ID

### éŸ³è‰²é€‰æ‹©

#### OpenAI å…¼å®¹éŸ³è‰²
- `shimmer` - æ¸©æŸ”å¥³å£°
- `alloy` - ä¸“ä¸šç”·å£°  
- `fable` - æ¿€æƒ…ç”·å£°
- `onyx` - æ´»æ³¼å¥³å£°
- `nova` - é˜³å…‰ç”·å£°
- `echo` - ä¸œåŒ—å¥³å£°

#### é«˜çº§å‚æ•°
- `style` - è¯­éŸ³é£æ ¼ï¼ˆgeneral, chat, news, etc.ï¼‰
- `role` - è§’è‰²æ‰®æ¼”ï¼ˆYoungAdultFemale, etc.ï¼‰
- `styleDegree` - é£æ ¼å¼ºåº¦ (0.01-2.0)

### æ–‡æœ¬æ¸…ç†é€‰é¡¹

```json
{
  "remove_markdown": true,
  "remove_emoji": true,
  "remove_urls": true,
  "remove_line_breaks": false,
  "remove_citation_numbers": true,
  "custom_keywords": "å…³é”®è¯1,å…³é”®è¯2"
}
```

### æµå¼æ’­æ”¾ç¤ºä¾‹

```bash
curl -X POST "https://your-domain.pages.dev/v1/audio/speech" \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "model": "tts-1",
    "voice": "nova",
    "input": "è¿™æ˜¯ä¸€ä¸ªé•¿æ–‡æœ¬ç¤ºä¾‹...",
    "stream": true
  }' --output streaming.mp3
```

## ï¿½ï¿½ é¡¹ç›®æ–‡ä»¶

- **`_worker.js`**: æ ¸å¿ƒæœåŠ¡æ–‡ä»¶ï¼ŒåŒ…å«å®Œæ•´åŠŸèƒ½
- **`screenshorts/`**: é…ç½®ç¤ºä¾‹å›¾ç‰‡
- **`tts_list/`**: å®Œæ•´éŸ³è‰²åˆ—è¡¨æ–‡ä»¶

## âš ï¸ é™åˆ¶è¯´æ˜

- **å­—ç¬¦æ•°é™åˆ¶**: å•æ¬¡è¯·æ±‚çº¦ 12 ä¸‡å­—ç¬¦
- **å…è´¹å¥—é¤**: é€‚ç”¨äº Cloudflare å…è´¹å¥—é¤
- **é¦–æ¬¡éƒ¨ç½²**: å¯èƒ½éœ€è¦ç­‰å¾… 1-2 åˆ†é’Ÿåˆå§‹åŒ–

## ğŸ”— ç›¸å…³é“¾æ¥

- [GitHub é¡¹ç›®](https://github.com/samni728/edgetts-cloudflare-workers-webui)
- [v1.2 Release](https://github.com/samni728/edgetts-cloudflare-workers-webui/releases/tag/v1.2)
- [Edge TTS éŸ³è‰²åˆ—è¡¨](https://learn.microsoft.com/zh-cn/azure/ai-services/speech-service/language-support?tabs=tts#multilingual-voices)

## âš–ï¸ ä½¿ç”¨å£°æ˜

- æœ¬æœåŠ¡åŸºäºå¾®è½¯ Edge TTS æŠ€æœ¯ï¼Œæä¾›æ–‡æœ¬è½¬è¯­éŸ³åŠŸèƒ½
- ç”¨æˆ·æ•°æ®å­˜å‚¨åœ¨ç”¨æˆ·è‡ªå·±çš„ Cloudflare KV ä¸­ï¼Œå®Œå…¨ç”±ç”¨æˆ·æ§åˆ¶
- è¯·éµå®ˆç›¸å…³æ³•å¾‹æ³•è§„ï¼Œä¸å¾—ç”¨äºè¿æ³•ç”¨é€”
- ä½¿ç”¨æœ¬æœåŠ¡å³è¡¨ç¤ºæ‚¨åŒæ„ç›¸å…³æ¡æ¬¾
